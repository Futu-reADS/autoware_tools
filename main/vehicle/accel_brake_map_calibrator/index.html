
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://autowarefoundation.github.io/autoware_tools/main/vehicle/accel_brake_map_calibrator/">
      
      
        <link rel="prev" href="../../simulator/simulator_compatibility_test/">
      
      
      <link rel="icon" href="../../docs/assets/images/autoware-foundation.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.20">
    
    
      
        <title>accel_brake_map_calibrator - Autoware Universe Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/assets/css/extra.css">
    
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#accel_brake_map_calibrator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Autoware Universe Documentation" class="md-header__button md-logo" aria-label="Autoware Universe Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M135.2 117.4 109.1 192h293.8l-26.1-74.6c-4.5-12.8-16.6-21.4-30.2-21.4H165.4c-13.6 0-25.7 8.6-30.2 21.4zm-95.6 79.4L74.8 96.3C88.3 57.8 124.6 32 165.4 32h181.2c40.8 0 77.1 25.8 90.6 64.3l35.2 100.5c23.2 9.6 39.6 32.5 39.6 59.2v192c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-48H96v48c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V256c0-26.7 16.4-49.6 39.6-59.2zM128 288a32 32 0 1 0-64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Autoware Universe Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              accel_brake_map_calibrator
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/autowarefoundation/autoware_tools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../bag2lanelet/" class="md-tabs__link">
        Bag2lanelet
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../common/tier4_debug_tools/" class="md-tabs__link">
        Common
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../planning/planning_debug_tools/" class="md-tabs__link">
        Planning
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../simulator/simulator_compatibility_test/" class="md-tabs__link">
        Simulator
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Vehicle
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Autoware Universe Documentation" class="md-nav__button md-logo" aria-label="Autoware Universe Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M135.2 117.4 109.1 192h293.8l-26.1-74.6c-4.5-12.8-16.6-21.4-30.2-21.4H165.4c-13.6 0-25.7 8.6-30.2 21.4zm-95.6 79.4L74.8 96.3C88.3 57.8 124.6 32 165.4 32h181.2c40.8 0 77.1 25.8 90.6 64.3l35.2 100.5c23.2 9.6 39.6 32.5 39.6 59.2v192c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-48H96v48c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V256c0-26.7 16.4-49.6 39.6-59.2zM128 288a32 32 0 1 0-64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"/></svg>

    </a>
    Autoware Universe Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/autowarefoundation/autoware_tools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../bag2lanelet/">Bag2lanelet</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Bag2lanelet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../common/tier4_debug_tools/">Tier4 debug tools</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Tier4 debug tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Planning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Planning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../planning/planning_debug_tools/">Planning debug tools</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Planning debug tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../planning/planning_debug_tools/doc-stop-reason-visualizer/" class="md-nav__link">
        Doc stop reason visualizer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Simulator
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Simulator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../simulator/simulator_compatibility_test/">Simulator compatibility test</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Simulator compatibility test
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Vehicle
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Vehicle
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">Accel brake map calibrator</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Accel brake map calibrator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-calibrate" class="md-nav__link">
    How to calibrate
  </a>
  
    <nav class="md-nav" aria-label="How to calibrate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launch-calibrator" class="md-nav__link">
    Launch Calibrator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calibration-plugin" class="md-nav__link">
    Calibration plugin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagnostics" class="md-nav__link">
    Diagnostics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluation-of-the-accel-brake-map-accuracy" class="md-nav__link">
    Evaluation of the accel / brake map accuracy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-visualize-calibration-data" class="md-nav__link">
    How to visualize calibration data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-save-the-calibrated-accel-brake-map-anytime-you-want" class="md-nav__link">
    How to save the calibrated accel / brake map anytime you want
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-parameters" class="md-nav__link">
    System Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm-parameters" class="md-nav__link">
    Algorithm Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-utility-scripts" class="md-nav__link">
    Test utility scripts
  </a>
  
    <nav class="md-nav" aria-label="Test utility scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-accelbrake-command-test" class="md-nav__link">
    Constant accel/brake command test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calibration-method" class="md-nav__link">
    Calibration Method
  </a>
  
    <nav class="md-nav" aria-label="Calibration Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preprocessing" class="md-nav__link">
    Data Preprocessing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_offset_each_cell" class="md-nav__link">
    update_offset_each_cell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_offset_four_cell_around-1" class="md-nav__link">
    update_offset_four_cell_around [1]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<div><h1 id="accel_brake_map_calibrator">accel_brake_map_calibrator<a class="headerlink" href="#accel_brake_map_calibrator" title="Permanent link">#</a></h1>
<p>The role of this node is to automatically calibrate <code>accel_map.csv</code> / <code>brake_map.csv</code> used in the <code>raw_vehicle_cmd_converter</code> node.</p>
<p>The base map, which is lexus's one by default, is updated iteratively with the loaded driving data.</p>
<h2 id="how-to-calibrate">How to calibrate<a class="headerlink" href="#how-to-calibrate" title="Permanent link">#</a></h2>
<h3 id="launch-calibrator">Launch Calibrator<a class="headerlink" href="#launch-calibrator" title="Permanent link">#</a></h3>
<p>After launching Autoware, run the <code>accel_brake_map_calibrator</code> by the following command and then perform autonomous driving. Note: You can collect data with manual driving if it is possible to use the same vehicle interface as during autonomous driving (e.g. using a joystick).</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>accel_brake_map_calibrator.launch.xml<span class="w"> </span>rviz:<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<p>Or if you want to use rosbag files, run the following commands.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>launch<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>accel_brake_map_calibrator.launch.xml<span class="w"> </span>rviz:<span class="o">=</span><span class="nb">true</span><span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
ros2<span class="w"> </span>bag<span class="w"> </span>play<span class="w"> </span>&lt;rosbag_file&gt;<span class="w"> </span>--clock
</code></pre></div>
<p>During the calibration with setting the parameter <code>progress_file_output</code> to true, the log file is output in [directory of <em>accel_brake_map_calibrator</em>]/config/ . You can also see accel and brake maps in [directory of <em>accel_brake_map_calibrator</em>]/config/accel_map.csv and [directory of <em>accel_brake_map_calibrator</em>]/config/brake_map.csv after calibration.</p>
<h3 id="calibration-plugin">Calibration plugin<a class="headerlink" href="#calibration-plugin" title="Permanent link">#</a></h3>
<p>The <code>rviz:=true</code> option displays the RViz with a calibration plugin as below.</p>
<p align="center">
<img src="./media/calib_rviz_image_sample.png" width="600">
</p>

<p>The current status (velocity and pedal) is shown in the plugin. The color on the current cell varies green/red depending on the current data is valid/invalid. The data that doesn't satisfy the following conditions are considered invalid and will not be used for estimation since aggressive data (e.g. when the pedal is moving fast) causes bad calibration accuracy.</p>
<ul>
<li>The velocity and pedal conditions are within certain ranges from the index values.</li>
<li>The steer value, pedal speed, pitch value, etc. are less than corresponding thresholds.</li>
<li>The velocity is higher than a threshold.</li>
</ul>
<p>The detailed parameters are described in the parameter section.</p>
<p>Note: You don't need to worry about whether the current state is red or green during calibration. Just keep getting data until all the cells turn red.</p>
<p>The value of each cell in the map is gray at first, and it changes from blue to red as the number of valid data in the cell accumulates. It is preferable to continue the calibration until each cell of the map becomes close to red. In particular, the performance near the stop depends strongly on the velocity of 0 ~ 6m/s range and the pedal value of +0.2 ~ -0.4, range so it is desirable to focus on those areas.</p>
<h3 id="diagnostics">Diagnostics<a class="headerlink" href="#diagnostics" title="Permanent link">#</a></h3>
<p>The <code>accel brake map_calibrator</code> publishes diagnostics message depending on the calibration status.
Diagnostic type <code>WARN</code> indicates that the current accel/brake map is estimated to be inaccurate. In this situation, it is strongly recommended to perform a re-calibration of the accel/brake map.</p>
<table>
<thead>
<tr>
<th>Status</th>
<th>Diagnostics Type</th>
<th>Diagnostics message</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>No calibration required</td>
<td><code>OK</code></td>
<td>"OK"</td>
<td></td>
</tr>
<tr>
<td>Calibration Required</td>
<td><code>WARN</code></td>
<td>"Accel/brake map Calibration is required."</td>
<td>The accuracy of current accel/brake map may be low.</td>
</tr>
</tbody>
</table>
<p>This diagnostics status can be also checked on the following ROS topic.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>topic<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>/accel_brake_map_calibrator/output/update_suggest
</code></pre></div>
<p>When the diagnostics type is <code>WARN</code>, <code>True</code> is published on this topic and the update of the accel/brake map is suggested.</p>
<h3 id="evaluation-of-the-accel-brake-map-accuracy">Evaluation of the accel / brake map accuracy<a class="headerlink" href="#evaluation-of-the-accel-brake-map-accuracy" title="Permanent link">#</a></h3>
<p>The accuracy of map is evaluated by the <strong>Root Mean Squared Error (RMSE)</strong> between the observed acceleration and predicted acceleration.</p>
<p><strong>TERMS:</strong></p>
<ul>
<li><code>Observed acceleration</code>: the current vehicle acceleration which is calculated as a derivative value of the wheel speed.</li>
</ul>
<ul>
<li><code>Predicted acceleration</code>: the output of the original accel/brake map, which the Autoware is expecting. The value is calculated using the current pedal and velocity.</li>
</ul>
<p>You can check additional error information with the following topics.</p>
<ul>
<li><code>/accel_brake_map_calibrator/output/current_map_error</code> : The error of the original map set in the <code>csv_path_accel/brake_map</code> path. The original map is not accurate if this value is large.</li>
<li><code>/accel_brake_map_calibrator/output/updated_map_error</code> : The error of the map calibrated in this node. The calibration quality is low if this value is large.</li>
<li><code>/accel_brake_map_calibrator/output/map_error_ratio</code> : The error ratio between the original map and updated map (ratio = updated / current). If this value is less than 1, it is desirable to update the map.</li>
</ul>
<h3 id="how-to-visualize-calibration-data">How to visualize calibration data<a class="headerlink" href="#how-to-visualize-calibration-data" title="Permanent link">#</a></h3>
<p>The process of calibration can be visualized as below. Since these scripts need the log output of the calibration, the <code>pedal_accel_graph_output</code> parameter must be set to true while the calibration is running for the visualization.</p>
<h4 id="visualize-plot-of-relation-between-acceleration-and-pedal">Visualize plot of relation between acceleration and pedal<a class="headerlink" href="#visualize-plot-of-relation-between-acceleration-and-pedal" title="Permanent link">#</a></h4>
<p>The following command shows the plot of used data in the calibration. In each plot of velocity ranges, you can see the distribution of the relationship between pedal and acceleration, and raw data points with colors according to their pitch angles.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>run<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>view_plot.py
</code></pre></div>
<p><img alt="sample pic" src="media/log_sample.png"></p>
<h4 id="visualize-statistics-about-accelerationvelocitypedal-data">Visualize statistics about acceleration/velocity/pedal data<a class="headerlink" href="#visualize-statistics-about-accelerationvelocitypedal-data" title="Permanent link">#</a></h4>
<p>The following command shows the statistics of the calibration:</p>
<ul>
<li>mean value</li>
<li>standard deviation</li>
<li>number of data</li>
</ul>
<p>of all data in each map cell.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>run<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>view_statistics.py
</code></pre></div>
<p><img alt="sample pic2" src="media/statistics_sample.png"></p>
<h3 id="how-to-save-the-calibrated-accel-brake-map-anytime-you-want">How to save the calibrated accel / brake map anytime you want<a class="headerlink" href="#how-to-save-the-calibrated-accel-brake-map-anytime-you-want" title="Permanent link">#</a></h3>
<p>You can save accel and brake map anytime with the following command.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>service<span class="w"> </span>call<span class="w"> </span>/accel_brake_map_calibrator/update_map_dir<span class="w"> </span>tier4_vehicle_msgs/srv/UpdateAccelBrakeMap<span class="w"> </span><span class="s2">"path: '&lt;accel/brake map directory&gt;'"</span>
</code></pre></div>
<p>You can also save accel and brake map in the default directory where Autoware reads accel_map.csv/brake_map.csv using the RViz plugin (AccelBrakeMapCalibratorButtonPanel) as following.</p>
<ol>
<li>
<p>Click <em>Panels</em> tab, and select AccelBrakeMapCalibratorButtonPanel.</p>
<p><img alt="add_panel" src="media/add_panel.png"></p>
</li>
<li>
<p>Select the panel, and the button will appear at the bottom of RViz.</p>
<p><img alt="calibrator_button_panel" src="media/calibrator_button_panel.png"></p>
</li>
<li>
<p>Press the button, and the accel / brake map will be saved.
   (The button cannot be pressed in certain situations, such as when the calibrator node is not running.)</p>
<p><img alt="push_calibration_button" src="media/push_calibration_button.png"></p>
</li>
</ol>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">#</a></h2>
<h2 id="system-parameters">System Parameters<a class="headerlink" href="#system-parameters" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Type</th>
<th align="left">Description</th>
<th align="left">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">update_method</td>
<td align="left">string</td>
<td align="left">you can select map calibration method. "update_offset_each_cell" calculates offsets for each grid cells on the map. "update_offset_total" calculates the total offset of the map.</td>
<td align="left">"update_offset_each_cell"</td>
</tr>
<tr>
<td align="left">get_pitch_method</td>
<td align="left">string</td>
<td align="left">"tf": get pitch from tf, "none": unable to perform pitch validation and pitch compensation</td>
<td align="left">"tf"</td>
</tr>
<tr>
<td align="left">pedal_accel_graph_output</td>
<td align="left">bool</td>
<td align="left">if true, it will output a log of the pedal accel graph.</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">progress_file_output</td>
<td align="left">bool</td>
<td align="left">if true, it will output a log and csv file of the update process.</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left">default_map_dir</td>
<td align="left">str</td>
<td align="left">directory of default map</td>
<td align="left">[directory of <em>raw_vehicle_cmd_converter</em>]/data/default/</td>
</tr>
<tr>
<td align="left">calibrated_map_dir</td>
<td align="left">str</td>
<td align="left">directory of calibrated map</td>
<td align="left">[directory of <em>accel_brake_map_calibrator</em>]/config/</td>
</tr>
<tr>
<td align="left">update_hz</td>
<td align="left">double</td>
<td align="left">hz for update</td>
<td align="left">10.0</td>
</tr>
</tbody>
</table>
<h2 id="algorithm-parameters">Algorithm Parameters<a class="headerlink" href="#algorithm-parameters" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Type</th>
<th align="left">Description</th>
<th align="left">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">initial_covariance</td>
<td align="left">double</td>
<td align="left">Covariance of initial acceleration map (larger covariance makes the update speed faster)</td>
<td align="left">0.05</td>
</tr>
<tr>
<td align="left">velocity_min_threshold</td>
<td align="left">double</td>
<td align="left">Speeds smaller than this are not used for updating.</td>
<td align="left">0.1</td>
</tr>
<tr>
<td align="left">velocity_diff_threshold</td>
<td align="left">double</td>
<td align="left">When the velocity data is more than this threshold away from the grid reference speed (center value), the associated data is not used for updating.</td>
<td align="left">0.556</td>
</tr>
<tr>
<td align="left">max_steer_threshold</td>
<td align="left">double</td>
<td align="left">If the steer angle is greater than this value, the associated data is not used for updating.</td>
<td align="left">0.2</td>
</tr>
<tr>
<td align="left">max_pitch_threshold</td>
<td align="left">double</td>
<td align="left">If the pitch angle is greater than this value, the associated data is not used for updating.</td>
<td align="left">0.02</td>
</tr>
<tr>
<td align="left">max_jerk_threshold</td>
<td align="left">double</td>
<td align="left">If the ego jerk calculated from ego acceleration is greater than this value, the associated data is not used for updating.</td>
<td align="left">0.7</td>
</tr>
<tr>
<td align="left">pedal_velocity_thresh</td>
<td align="left">double</td>
<td align="left">If the pedal moving speed is greater than this value, the associated data is not used for updating.</td>
<td align="left">0.15</td>
</tr>
<tr>
<td align="left">pedal_diff_threshold</td>
<td align="left">double</td>
<td align="left">If the current pedal value is more then this threshold away from the previous value, the associated data is not used for updating.</td>
<td align="left">0.03</td>
</tr>
<tr>
<td align="left">max_accel</td>
<td align="left">double</td>
<td align="left">Maximum value of acceleration calculated from velocity source.</td>
<td align="left">5.0</td>
</tr>
<tr>
<td align="left">min_accel</td>
<td align="left">double</td>
<td align="left">Minimum value of acceleration calculated from velocity source.</td>
<td align="left">-5.0</td>
</tr>
<tr>
<td align="left">pedal_to_accel_delay</td>
<td align="left">double</td>
<td align="left">The delay time between actuation_cmd to acceleration, considered in the update logic.</td>
<td align="left">0.3</td>
</tr>
<tr>
<td align="left">update_suggest_thresh</td>
<td align="left">double</td>
<td align="left">threshold of RMSE ratio that update suggest flag becomes true. ( RMSE ratio: [RMSE of new map] / [RMSE of original map] )</td>
<td align="left">0.7</td>
</tr>
<tr>
<td align="left">max_data_count</td>
<td align="left">int</td>
<td align="left">For visualization. When the data num of each grid gets this value, the grid color gets red.</td>
<td align="left">100</td>
</tr>
<tr>
<td align="left">accel_brake_value_source</td>
<td align="left">string</td>
<td align="left">Whether to use actuation_status or actuation_command as accel/brake sources. value</td>
<td align="left">status</td>
</tr>
</tbody>
</table>
<h2 id="test-utility-scripts">Test utility scripts<a class="headerlink" href="#test-utility-scripts" title="Permanent link">#</a></h2>
<h3 id="constant-accelbrake-command-test">Constant accel/brake command test<a class="headerlink" href="#constant-accelbrake-command-test" title="Permanent link">#</a></h3>
<p>These scripts are useful to test for accel brake map calibration. These generate an <code>ActuationCmd</code> with a constant accel/brake value given interactively by a user through CLI.</p>
<ul>
<li>accel_tester.py</li>
<li>brake_tester.py</li>
<li>actuation_cmd_publisher.py</li>
</ul>
<p>The <code>accel/brake_tester.py</code> receives a target accel/brake command from CLI. It sends a target value to <code>actuation_cmd_publisher.py</code> which generates the <code>ActuationCmd</code>. You can run these scripts by the following commands in the different terminals, and it will be as in the screenshot below.</p>
<div class="highlight"><pre><span></span><code>ros2<span class="w"> </span>run<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>accel_tester.py
ros2<span class="w"> </span>run<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>brake_tester.py
ros2<span class="w"> </span>run<span class="w"> </span>accel_brake_map_calibrator<span class="w"> </span>actuation_cmd_publisher.py
</code></pre></div>
<p><img alt="actuation_cmd_publisher_util" src="media/actuation_cmd_publisher_util.png"></p>
<h2 id="calibration-method">Calibration Method<a class="headerlink" href="#calibration-method" title="Permanent link">#</a></h2>
<p>Two algorithms are selectable for the acceleration map update, <a href="#update_offset_four_cell_around-1">update_offset_four_cell_around</a> and <a href="#update_offset_each_cell">update_offset_each_cell</a>. Please see the link for details.</p>
<h3 id="data-preprocessing">Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permanent link">#</a></h3>
<p>Before calibration, missing or unusable data (e.g., too large handle angles) must first be eliminated. The following parameters are used to determine which data to remove.</p>
<h4 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>velocity_min_threshold</td>
<td>Exclude minimal velocity</td>
<td>0.1</td>
</tr>
<tr>
<td>max_steer_threshold</td>
<td>Exclude large steering angle</td>
<td>0.2</td>
</tr>
<tr>
<td>max_pitch_threshold</td>
<td>Exclude large pitch angle</td>
<td>0.02</td>
</tr>
<tr>
<td>max_jerk_threshold</td>
<td>Exclude large jerk</td>
<td>0.7</td>
</tr>
<tr>
<td>pedal_velocity_thresh</td>
<td>Exclude large pedaling speed</td>
<td>0.15</td>
</tr>
</tbody>
</table>
<h3 id="update_offset_each_cell">update_offset_each_cell<a class="headerlink" href="#update_offset_each_cell" title="Permanent link">#</a></h3>
<p>Update by Recursive Least Squares(RLS) method using data close enough to each grid.</p>
<p><strong>Advantage</strong> : Only data close enough to each grid is used for calibration, allowing accurate updates at each point.</p>
<p><strong>Disadvantage</strong> : Calibration is time-consuming due to a large amount of data to be excluded.</p>
<h4 id="parameters_2">Parameters<a class="headerlink" href="#parameters_2" title="Permanent link">#</a></h4>
<p>Data selection is determined by the following thresholds.
| Name | Default Value |
| ----------------------- | ------------- |
| velocity_diff_threshold | 0.556 |
| pedal_diff_threshold | 0.03 |</p>
<h4 id="update-formula">Update formula<a class="headerlink" href="#update-formula" title="Permanent link">#</a></h4>
<div class="arithmatex">\[
\begin{align}
    \theta[n]=&amp;
    \theta[n-1]+\frac{p[n-1]x^{(n)}}{\lambda+p[n-1]{(x^{(n)})}^2}(y^{(n)}-\theta[n-1]x^{(n)})\\
    p[n]=&amp;\frac{p[n-1]}{\lambda+p[n-1]{(x^{(n)})}^2}
\end{align}
\]</div>
<h4 id="variables">Variables<a class="headerlink" href="#variables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Variable name</th>
<th>Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td>covariance</td>
<td><span class="arithmatex">\(p[n-1]\)</span></td>
</tr>
<tr>
<td>map_offset</td>
<td><span class="arithmatex">\(\theta[n]\)</span></td>
</tr>
<tr>
<td>forgetting<em>factor</em></td>
<td><span class="arithmatex">\(\lambda\)</span></td>
</tr>
<tr>
<td>phi</td>
<td><span class="arithmatex">\(x(=1)\)</span></td>
</tr>
<tr>
<td>measured_acc</td>
<td><span class="arithmatex">\(y\)</span></td>
</tr>
</tbody>
</table>
<h3 id="update_offset_four_cell_around-1">update_offset_four_cell_around [1]<a class="headerlink" href="#update_offset_four_cell_around-1" title="Permanent link">#</a></h3>
<p>Update the offsets by RLS in four grids around newly obtained data. By considering linear interpolation, the update takes into account appropriate weights. Therefore, there is no need to remove data by thresholding.</p>
<p><strong>Advantage</strong> : No data is wasted because updates are performed on the 4 grids around the data with appropriate weighting.
<strong>Disadvantage</strong> : Accuracy may be degraded due to extreme bias of the data. For example, if data <span class="arithmatex">\(z(k)\)</span> is biased near <span class="arithmatex">\(Z_{RR}\)</span> in Fig. 2, updating is performed at the four surrounding points ( <span class="arithmatex">\(Z_{RR}\)</span>, <span class="arithmatex">\(Z_{RL}\)</span>, <span class="arithmatex">\(Z_{LR}\)</span>, and <span class="arithmatex">\(Z_{LL}\)</span>), but accuracy at <span class="arithmatex">\(Z_{LL}\)</span> is not expected.</p>
<!-- cspell: ignore fourcell -->
<p align="center">
  <img src="./media/fourcell_RLS.png" width="600">
</p>

<h4 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">#</a></h4>
<p>See eq.(7)-(10) in [1] for the updated formula. In addition, eq.(17),(18) from [1] are used for Anti-Windup.</p>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h3>
<!-- cspell: ignore Lochrie, Doljevic, Yongsoon, Yoon, IFAC -->

<p>[1] <a href="https://www.sciencedirect.com/science/article/pii/S240589632102320X">Gabrielle Lochrie, Michael Doljevic, Mario Nona, Yongsoon Yoon, Anti-Windup Recursive Least Squares Method for Adaptive Lookup Tables with Application to Automotive Powertrain Control Systems, IFAC-PapersOnLine, Volume 54, Issue 20, 2021, Pages 840-845</a></p></div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../simulator/simulator_compatibility_test/" class="md-footer__link md-footer__link--prev" aria-label="Previous: simulator_compatibility_test" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                simulator_compatibility_test
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 The Autoware Foundation
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../docs/assets/js/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>